
import D from '../../../D'
import {Buffer} from 'buffer'

export default class MockDevice {
  listenPlug (callback) {
    D.dispatch(() => callback(D.error.succeed, D.status.plugIn))
  }

  async sendAndReceive (reportId, apdu) {
    if (apdu.toString('hex') === '00040084000008') {
      return Buffer.from('020304a6cdf151561a61039000000000', 'hex')
    }
    if (apdu.toString('hex').startsWith('020480334b4e')) {
      return Buffer.from(
        '240B04' +
        // device cert
        'B1D74CE65A02C3C3C64B589EFD87C5016A3B3CB67201D65A257CBA7D9D29FC4F5BE20FB8C50DD36188B213360010457AFE97286B8833AFC62148820DC133B58E14D2FE57F3D6B6C5A46BC9B454A793310FEDDF7557D14743DBFEBB90FBA8F9A7A5CA2500765AB02D5521AC56DDDC419F808197601A4C1A694B5914138A78F358' +
        // enc SKey
        '97F6675061EE11B79F1BB3472451D03FB89300F60EE56213D9D675155AD1428DAB3850237D5D6EE39F35E6EDD1546EDBC735862A537C080BC40959107CBA94F2C1C7C7B3886CE12293BD7BDC6B4247CAA50FF3698A2A367F1A896E8C7274055A22E953E63B73189024DBBA9E67E3814E190321A98EB181D05C51DF275C7BFD57' +
        // device signature
        '33498BD4DCBAB74E71BFBAA52F604715DA0C0AC3CD02B388B8216FCD0C491E71795DEC0F46E2BBECA00C0F0622816D354855B933FD018E6ADB451F6561EF490927DCE616BB0865A8644EE6B6F2EB36EC8FC5B85B455661614389177E33259AB74BD6143A9B3D9C62786CDA927D68D43C14ADC2ECCE3D2640E81F9E6B62021974' +
        '9000' +
        '0000000000000000000000', 'hex')
    }
    // enc apdu
    if (apdu.toString('hex').startsWith('06048033534d')) {
      return Buffer.from('0403044933397EE38DA493E94BE1566CE5CABEB71E73DA65EEB2069000000000', 'hex')
    }
  }

  static getTestTempRsaKeyPair () {
    // P: DC2256316F55F208178C91DFE94D1C077D9F5D0A39E4E6000921247F9DA359E18BD0FDD4C498DCF22429E6D277AC89795422CF295CE25C153CDDA3CC5402845F
    // Q: C62161D3E8C80244E4E616983211609F6A3A5DEE0967D0F4AC1A913C3C84C7FFA72DEC760DE3125706158BBC8405D599203885F4B67149E7DF31237D0372E0F1
    // Dp: 554CCCDF7D07EDB06B07A263047147C23350746A09030488D100D1B6CDABC5A15B5F516C87FDBFE7E851804ADFEAB09E9E169AF5A93361812D43A93BFCF5B8BB
    // Dq: 8B3629669BC8ECCF3B85EF9A4093B5304D93752C2BAFA642442AE6A14C647FA241F5229050719C1149551A39FB099E6B59185E06F3A9E623E5CEC100B5CBA201
    // Qinv: 9EDF52B0BC2FEE818C24A685AAB9D40E76E4E420C15D9690F85FD7D09322F43176582C9D068FC31B968A11950774766AC1A28B8E7A8AD16B5EF52E7981EA3BF7
    // N: AA5F4336939CB4186FF1E5119D3E93D1A33C72EED1F40718149B9B240C9DF300510C30C631FD583CA99CEA2956B7A4549797FCE307D3132AD599904389C0411791FEFC3214B55F1ECD615EDCF5A409184C7D30CEB31905B9007482A74815F8422195D4B4A64B43131A4A04424F14EE46BA5146FC9DB2B1A306760CEC597FBD6F
    // D: 8A7A2B936C9F6DF27EEACA196B09B5F42B0DB30D52315AA2C3FD463822D92EEE0EF22DA2AA7715051987A4FC3CB3BF29D29D82BAB55D66B2E6328F03962F61B786C75B3E517B71236102E5D54B644426D679D609998D2268820B84E3C6D20DF1737BCEC47D9882AE1C213B13DAAEBD5EEB8E602D55A2B3410429347CADE7E281
    return {
      pubKey: '-----BEGIN PUBLIC KEY-----' +
      'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCqX0M2k5y0GG/x5RGdPpPRozxy' +
      '7tH0BxgUm5skDJ3zAFEMMMYx/Vg8qZzqKVa3pFSXl/zjB9MTKtWZkEOJwEEXkf78' +
      'MhS1Xx7NYV7c9aQJGEx9MM6zGQW5AHSCp0gV+EIhldS0pktDExpKBEJPFO5GulFG' +
      '/J2ysaMGdgzsWX+9bwIDAQAB' +
      '-----END PUBLIC KEY-----',
      privKey: '-----BEGIN RSA PRIVATE KEY-----' +
      'MIICXgIBAAKBgQCqX0M2k5y0GG/x5RGdPpPRozxy7tH0BxgUm5skDJ3zAFEMMMYx/Vg8qZzqKVa3pFSXl/zjB9MTKtWZkEOJwEEXkf78MhS1Xx7NYV7c9aQJGEx9MM6zGQW5AHSCp0gV+EIhldS0pktDExpKBEJPFO5GulFG/J2ysaMGdgzsWX+9bwIDAQABAoGBAIp6K5Nsn23yfurKGWsJtfQrDbMNUjFaosP9Rjgi2S7uDvItoqp3FQUZh6T8PLO/KdKdgrq1XWay5jKPA5YvYbeGx1s+UXtxI2EC5dVLZEQm1nnWCZmNImiCC4TjxtIN8XN7zsR9mIKuHCE7E9quvV7rjmAtVaKzQQQpNHyt5+KBAkEA3CJWMW9V8ggXjJHf6U0cB32fXQo55OYACSEkf52jWeGL0P3UxJjc8iQp5tJ3rIl5VCLPKVziXBU83aPMVAKEXwJBAMYhYdPoyAJE5OYWmDIRYJ9qOl3uCWfQ9KwakTw8hMf/py3sdg3jElcGFYu8hAXVmSA4hfS2cUnn3zEjfQNy4PECQFVMzN99B+2waweiYwRxR8IzUHRqCQMEiNEA0bbNq8WhW19RbIf9v+foUYBK3+qwnp4WmvWpM2GBLUOpO/z1uLsCQQCLNilmm8jszzuF75pAk7UwTZN1LCuvpkJEKuahTGR/okH1IpBQcZwRSVUaOfsJnmtZGF4G86nmI+XOwQC1y6IBAkEAnt9SsLwv7oGMJKaFqrnUDnbk5CDBXZaQ+F/X0JMi9DF2WCydBo/DG5aKEZUHdHZqwaKLjnqK0Wte9S55geo79w==' +
      '-----END RSA PRIVATE KEY-----'
    }
  }
}
