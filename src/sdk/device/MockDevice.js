
import D from '../D'
import IEsDevice from './IEsDevice'

export default class MockDevice extends IEsDevice {
  constructor () {
    super()
    this.currentAddressIndex = 0
  }
  listenPlug (callback) {
    D.dispatch(() => callback(D.error.succeed, D.status.plugIn))
  }

  async sendAndReceive (reportId, apdu) {
    if (D.toHex(apdu) === '00040084000008') {
      return D.toBuffer('020304a6cdf151561a61039000000000')
    }
    if (D.toHex(apdu).startsWith('80334B4E')) {
      return D.toBuffer(
        '240B04' +
        // device cert
        'B1D74CE65A02C3C3C64B589EFD87C5016A3B3CB67201D65A257CBA7D9D29FC4F5BE20FB8C50DD36188B213360010457AFE97286B8833AFC62148820DC133B58E14D2FE57F3D6B6C5A46BC9B454A793310FEDDF7557D14743DBFEBB90FBA8F9A7A5CA2500765AB02D5521AC56DDDC419F808197601A4C1A694B5914138A78F358' +
        // enc SKey
        '97F6675061EE11B79F1BB3472451D03FB89300F60EE56213D9D675155AD1428DAB3850237D5D6EE39F35E6EDD1546EDBC735862A537C080BC40959107CBA94F2C1C7C7B3886CE12293BD7BDC6B4247CAA50FF3698A2A367F1A896E8C7274055A22E953E63B73189024DBBA9E67E3814E190321A98EB181D05C51DF275C7BFD57' +
        // device signature
        '33498BD4DCBAB74E71BFBAA52F604715DA0C0AC3CD02B388B8216FCD0C491E71795DEC0F46E2BBECA00C0F0622816D354855B933FD018E6ADB451F6561EF490927DCE616BB0865A8644EE6B6F2EB36EC8FC5B85B455661614389177E33259AB74BD6143A9B3D9C62786CDA927D68D43C14ADC2ECCE3D2640E81F9E6B62021974' +
        '9000' +
        '0000000000000000000000')
    }
  }
}
